function getAdjustedIndex(n){switch($(".board").attr("orientation").toLowerCase()){case"black":return 7-n;case"white":return n}}function pieceClick(n,t){$(".selected").removeClass("selected");$("#piece"+n+t).addClass("selected");$(".selected").closest("rect").css("stroke-width","1")}function boardClick(n,t){if($(".selected").length!==0){var i=$(".selected").attr("id").replace("piece",""),r=getAdjustedIndex(parseInt(i[0])),u=getAdjustedIndex(parseInt(i[1]));$.ajax("/Board/MovePiece",{data:{id:$(".board").attr("id"),start:{row:r,column:u},end:{row:getAdjustedIndex(n),column:getAdjustedIndex(t)}},dataType:"html",method:"POST"})}}function undo(){$.ajax("/Board/Undo",{data:{id:$(".board").attr("id")},dataType:"html",method:"POST"})}function resign(){$.ajax("/Board/Resign",{data:{id:$(".board").attr("id")},dataType:"html",method:"POST"})}function joinGame(){$.ajax("/Board/Join",{data:{id:$(".board").attr("id")},dataType:"html",method:"POST"})}function displayGame(n){$.ajax("/Board/DisplayGame",{data:{moveID:n,orientation:$(".board").attr("orientation")},dataType:"html",method:"POST",success:function(n){$(".board")[0].outerHTML=n}})}function flip(){switch($(".board").attr("orientation").toLowerCase()){case"black":$(".board").attr("orientation","White");break;case"white":$(".board").attr("orientation","Black")}var n=$(".moves li input:checked");n.length===0&&(n=$(".moves li input:last"));$.ajax("/Board/Orientate",{data:{id:$(".board").attr("id"),moveID:n.length===0?"":n.attr("id"),orientation:$(".board").attr("orientation")},dataType:"html",method:"POST",success:function(n){$(".board")[0].outerHTML=n}})}function connectToBoard(){var t=new signalR.HttpConnection("/boardHub"),n=new signalR.HubConnection(t);n.on("Update",function(n,t,i){if($(".board").attr("id").toLowerCase()===n.toLowerCase()){console.log($(".board").attr("orientation").toLowerCase());switch($(".board").attr("orientation").toLowerCase()){case"black":$(".board")[0].outerHTML=t;break;case"white":$(".board")[0].outerHTML=i}}});n.start()}function connectToMoveControl(){var t=new signalR.HttpConnection("/movesHub"),n=new signalR.HubConnection(t);n.on("Update",function(n){$(".moves")[0].outerHTML=n});n.start()}function connectToOpponents(){var t=new signalR.HttpConnection("/opponentsHub"),n=new signalR.HubConnection(t);n.on("Update",function(n,t){var i=["black","white"].filter(function(t){return t!=n.toLowerCase()})[0];$("#"+i.toLowerCase()+"-player-text").removeClass("bold");switch(t){case"WhiteWin":$(".player-to-move").html("White Won");$(".win-status").html("1 - 0");break;case"BlackWin":$(".player-to-move").html("Black Won");$(".win-status").html("0 - 1");break;case"Drawn":$(".player-to-move").html("Game Drawn");$(".win-status").html("½ - ½");break;case"InProgress":$(".player-to-move").html(n+"'s Turn");$(".win-status").html("*");$("#"+n.toLowerCase()+"-player-text").addClass("bold")}});n.start()}function connectToControl(){var t=new signalR.HttpConnection("/controlHub"),n=new signalR.HubConnection(t);n.on("SetAttribute",function(n,t,i){$("#"+n).attr(t,i)});n.on("RemoveAttribute",function(n,t){$("#"+n).removeAttr(t)});n.on("AddClass",function(n,t){$("#"+n).addClass(t)});n.on("RemoveClass",function(n,t){$("#"+n).removeClass(t)});n.start()}(function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery"],n):typeof module!="undefined"&&module.exports?module.exports=n(require("jquery")):n(jQuery)})(function(n){var o=-1,r=-1,i=function(n){return parseFloat(n)||0},s=function(t){var f=1,e=n(t),u=null,r=[];return e.each(function(){var t=n(this),e=t.offset().top-i(t.css("margin-top")),o=r.length>0?r[r.length-1]:null;o===null?r.push(t):Math.floor(Math.abs(u-e))<=f?r[r.length-1]=o.add(t):r.push(t);u=e}),r},u=function(t){var i={byRow:!0,property:"height",target:null,remove:!1,subtractFromTarget:0};return typeof t=="object"?n.extend(i,t):(typeof t=="boolean"?i.byRow=t:t==="remove"&&(i.remove=!0),i)},t=n.fn.matchHeight=function(i){var r=u(i),f;return r.remove?(f=this,this.css(r.property,""),n.each(t._groups,function(n,t){t.elements=t.elements.not(f)}),this):this.length<=1&&!r.target?this:(t._groups.push({elements:this,options:r}),t._apply(this,r),this)},f,e;t.version="master";t._groups=[];t._throttle=80;t._maintainScroll=!1;t._beforeUpdate=null;t._afterUpdate=null;t._rows=s;t._parse=i;t._parseOptions=u;t._apply=function(r,f){var e=u(f),o=n(r),c=[o],l=n(window).scrollTop(),a=n("html").outerHeight(!0),h=o.parents().filter(":hidden");return h.each(function(){var t=n(this);t.data("style-cache",t.attr("style"))}),h.css("display","block"),e.byRow&&!e.target&&(o.each(function(){var i=n(this),t=i.css("display");t!=="inline-block"&&t!=="flex"&&t!=="inline-flex"&&(t="block");i.data("style-cache",i.attr("style"));i.css({display:t,"padding-top":"0","padding-bottom":"0","margin-top":"0","margin-bottom":"0","border-top-width":"0","border-bottom-width":"0",height:"100px",overflow:"hidden"})}),c=s(o),o.each(function(){var t=n(this);t.attr("style",t.data("style-cache")||"")})),n.each(c,function(t,r){var f=n(r),u=0;if(e.target)u=e.target.outerHeight(!1);else{if(e.byRow&&f.length<=1){f.css(e.property,"");return}f.each(function(){var t=n(this),f=t.attr("style"),i=t.css("display"),r;i!=="inline-block"&&i!=="flex"&&i!=="inline-flex"&&(i="block");r={display:i};r[e.property]="";t.css(r);t.outerHeight(!1)>u&&(u=t.outerHeight(!1));f?t.attr("style",f):t.css("display","")})}f.each(function(){var t=n(this),r=0;e.target&&t.is(e.target)||(t.css("box-sizing")!=="border-box"&&(r+=i(t.css("border-top-width"))+i(t.css("border-bottom-width")),r+=i(t.css("padding-top"))+i(t.css("padding-bottom"))),console.log(u),console.log(r),console.log(e.subtractFromTarget),t.css(e.property,u-r-e.subtractFromTarget+"px"))})}),h.each(function(){var t=n(this);t.attr("style",t.data("style-cache")||null)}),t._maintainScroll&&n(window).scrollTop(l/a*n("html").outerHeight(!0)),this};t._applyDataApi=function(){var t={};n("[data-match-height], [data-mh]").each(function(){var i=n(this),r=i.attr("data-mh")||i.attr("data-match-height");t[r]=r in t?t[r].add(i):i});n.each(t,function(){this.matchHeight(!0)})};f=function(i){t._beforeUpdate&&t._beforeUpdate(i,t._groups);n.each(t._groups,function(){t._apply(this.elements,this.options)});t._afterUpdate&&t._afterUpdate(i,t._groups)};t._update=function(i,u){if(u&&u.type==="resize"){var e=n(window).width();if(e===o)return;o=e}i?r===-1&&(r=setTimeout(function(){f(u);r=-1},t._throttle)):f(u)};n(t._applyDataApi);e=n.fn.on?"on":"bind";n(window)[e]("load",function(n){t._update(!1,n)});n(window)[e]("resize orientationchange",function(n){t._update(!0,n)})});connectToBoard();connectToMoveControl();connectToOpponents();connectToControl();